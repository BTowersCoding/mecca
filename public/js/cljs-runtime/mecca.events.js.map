{"version":3,"sources":["mecca/events.cljs"],"mappings":"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","names":["re_frame.core.reg_event_db","_","js/AudioContext","day8.re_frame.undo.undoable","p__75994","vec__75995","cljs.core.nth","db","time","pitch","cljs.core.update","note","p1__75993#","cljs.core.remove","cljs.core._EQ_","mecca.events/test-atom","reagent.core.atom","p__75998","vec__75999","s","mecca.sci-editor/update-result!","mecca.sci-editor/eval-all","G__76005","cljs.core/deref","mecca.sci-editor/!points","cljs.core.assoc","G__76009","p__76010","vec__76011","file","p__76014","vec__76015","samples","p__76018","vec__76019","beats-per-measure","p__76022","vec__76023","notes","p__76026","vec__76027","new-time","p__76030","vec__76031","re_frame.core.subscribe","mecca.music/play-song!","p__76034","vec__76035","p__76038","vec__76039","cljs.core/not","p__76042","vec__76043","p__76046","vec__76047","p__76050","vec__76051","p__76054","vec__76055","re-frame.core/dispatch","p__76058","vec__76059","pos","p__76062","vec__76063","instrument","p__76066","vec__76067","p__76072","vec__76073","beat","to-play","p1__76070#","cljs.core.filter","p1__76071#","p__76077","vec__76078","beats","p1__76076#","p__76082","vec__76083","p1__76081#","p__76086","vec__76087","p__76091","vec__76092","p1__76090#","p__76095","vec__76096","p__76099","vec__76100","tempo","p__76104","vec__76105","p1__76103#","p__76109","vec__76110","p1__76108#","p__76113","vec__76114","key","p__76117","vec__76118","p__76121","vec__76122","x","p__76126","vec__76127","seconds-per-beat","p1__76125#","cljs.core/inc","p__76130","vec__76131","mecca.music/play-note","p__76135","vec__76136","p1__76134#","cljs.core/into","p__76139","vec__76140","mecca.music/play-sample","cljs.core/conj","p__76146","vec__76147","and__4221__auto__","cljs.core.not_EQ_","p1__76144#","p1__76143#","cljs.core.get","p1__76145#","p__76150","vec__76151","p__76154","vec__76155","xml","p__76158","vec__76159","p__76162","vec__76163","mecca.songs.megaman/megaman","p__76166","vec__76167","mecca.songs.city/city","p__76170","vec__76171","mecca.songs.zelda/zelda"],"sourcesContent":["(ns mecca.events\r\n  (:require\r\n   [re-frame.core :refer [reg-event-db reg-event-fx dispatch subscribe]]\r\n   [re-pressed.core :as rp]\r\n   [reagent.core :as r]\r\n   [mecca.sci-editor :as sci-editor :refer [!points points result !result eval-all]]\r\n   [day8.re-frame.undo :as undo :refer [undoable]]\r\n   [mecca.mario :as mario :refer [mario]]\r\n   [mecca.songs.megaman :as megaman]\r\n   [mecca.songs.zelda :as zelda]\r\n   [mecca.songs.city :as city]\r\n   [mecca.music :as music]\r\n   [goog.events :refer [listen unlisten]])\r\n  (:import [goog.events EventType]))\r\n\r\n(reg-event-db\r\n :initialize-db\r\n (fn [_ _]\r\n   {:audio-context (js/AudioContext.)\r\n    :samples nil\r\n    :focused-note-pos [nil nil]\r\n    :eraser? false\r\n    :playing? false\r\n    :play-start 0\r\n    :jumping? false\r\n    :sharp? false\r\n    :repeat? false\r\n    :loop-end nil\r\n    :current-position 0\r\n    :current-note 0\r\n    :next-note-time 0.0\r\n    :notes-in-queue []\r\n    :editor-beat-start 1\r\n    :instrument 1\r\n    :array-buffer nil\r\n    :time 0\r\n    :time-signature 4\r\n    :tempo 180\r\n    :notes []\r\n    :mario-x 16\r\n    :mario-y 61\r\n    :mario-jump 0\r\n    :mario-run 1\r\n    :xml \"\"\r\n    :eval-result \"\"\r\n    :file-upload \"\"}))\r\n\r\n(reg-event-db\r\n :remove-note\r\n (undoable \"remove note\")\r\n (fn [db [_ time pitch]]\r\n   (update db :notes\r\n           (fn [note]\r\n             (remove #(and (= time (:time %))\r\n                           (= pitch (:pitch %)))\r\n                     note)))))\r\n\r\n(def test-atom (r/atom \"\"))\r\n\r\n(reg-event-db\r\n :set-result\r\n (fn [db [_ s]]\r\n   (sci-editor/update-result! (str (eval-all (str (some-> @!points .-state .-doc str)))))\r\n   (assoc db :eval-result (str (eval-all (str (some-> @!points .-state .-doc str)))))))\r\n\r\n(reg-event-db\r\n :file-upload\r\n (fn [db [_ file]]\r\n      (assoc db :file-upload file)))\r\n\r\n(reg-event-db\r\n :load-samples\r\n (fn [db [_ samples]]\r\n   (assoc db :samples samples)))\r\n\r\n(reg-event-db\r\n :set-time-signature\r\n (fn [db [_ beats-per-measure]]\r\n   (update db :time-signature beats-per-measure)))\r\n\r\n(reg-event-db\r\n :set-notes\r\n (fn [db [_ notes]]\r\n   (assoc db :notes notes)))\r\n\r\n(reg-event-db                 ;; usage:  (dispatch [:timer a-js-Date])\r\n :timer                         ;; every second an event of this kind will be dispatched\r\n (fn [db [_ new-time]]          ;; note how the 2nd parameter is destructured to obtain the data value\r\n   (assoc db :time new-time)))\r\n\r\n(reg-event-db\r\n :play-on\r\n (fn [db [_ _]]\r\n   (.resume @(subscribe [:audio-context]))\r\n   (music/play-song!)\r\n   (assoc\r\n    (assoc db :play-start (.-currentTime @(subscribe [:audio-context])))\r\n    :playing? true)\r\n    ))\r\n\r\n(reg-event-db\r\n :sharp-on\r\n (fn [db [_ _]]\r\n   (assoc db :sharp? true)))\r\n\r\n(reg-event-db\r\n :sharp-toggle\r\n (fn [db [_ _]]\r\n   (update db :sharp? not)))\r\n\r\n(reg-event-db\r\n :eraser-toggle\r\n (fn [db [_ _]]\r\n   (update db :eraser? not)))\r\n\r\n(reg-event-db\r\n :sharp-off\r\n (fn [db [_ _]]\r\n   (assoc db :sharp? false)))\r\n\r\n(reg-event-db\r\n :pause\r\n (fn [db [_ _]]\r\n   (.suspend @(subscribe [:audio-context]))\r\n   (assoc db :playing? false)))\r\n\r\n(reg-event-db\r\n :stop\r\n (fn [db [_ _]]\r\n   (dispatch [:reset-editor])\r\n   (assoc\r\n    (assoc db :playing? false)\r\n    :current-position 0)))\r\n\r\n(reg-event-db\r\n :update-focus-note\r\n (fn [db [_ pos]]\r\n   (assoc db :focused-note-pos pos)))\r\n\r\n(reg-event-db\r\n :select-instrument\r\n (fn [db [_ instrument]]\r\n   (assoc db \r\n          :instrument instrument\r\n          :eraser? false)))\r\n\r\n(reg-event-db\r\n :play-off\r\n (fn [db [_ _]]\r\n   (assoc db :playing? false)))\r\n\r\n(reg-event-db\r\n :advance-position\r\n (fn [db [_ _]]\r\n   (let [notes (subscribe [:notes])\r\n         beat (subscribe [:current-position])\r\n         to-play (filter #(= (+ 1 @beat) (:time %)) @notes)]\r\n     (if (< 4 @beat)\r\n       (dispatch [:advance-editor 0.5]))\r\n     #_(doall (for [{:keys [instrument pitch]} to-play]\r\n                (music/play-sample instrument (if @(subscribe [:sharp?]) (+ 0.5 pitch) pitch))))\r\n     (update db :current-position #(+ 0.5 %)))))\r\n\r\n(reg-event-db\r\n :advance-editor\r\n (fn [db [_ beats]]\r\n   (update db :editor-beat-start #(+ beats %))))\r\n\r\n(reg-event-db\r\n :move-mario\r\n (fn [db [_ _]]\r\n   (update db :mario-x #(+ 10 %))))\r\n\r\n(reg-event-db\r\n :reset-editor\r\n (fn [db [_ _]]\r\n   (assoc (assoc db :editor-beat-start 1)\r\n          :mario-x 16)))\r\n\r\n(reg-event-db\r\n :retract-editor\r\n (fn [db [_ _]]\r\n   (update db :editor-beat-start #(- % 0.5))))\r\n\r\n(reg-event-db\r\n :reset-position\r\n (fn [db [_ _]]\r\n   (assoc db :current-position 0)))\r\n\r\n(reg-event-db\r\n :set-tempo\r\n (fn [db [_ tempo]]\r\n   (assoc db :tempo tempo)))\r\n\r\n(reg-event-db\r\n :inc-tempo\r\n (fn [db [_ tempo]]\r\n   (update db :tempo #(+ 8 %))))\r\n\r\n(reg-event-db\r\n :dec-tempo\r\n (fn [db [_ tempo]]\r\n   (update db :tempo #(- % 8))))\r\n\r\n(reg-event-db\r\n :set-key\r\n (fn [db [_ key]]\r\n   (assoc db :key key)))\r\n\r\n(reg-event-db\r\n :repeat-toggle\r\n (fn [db [_ _]]\r\n   (update db :repeat? not)))\r\n\r\n(reg-event-db\r\n :set-loop-end\r\n (fn [db [_ x]]\r\n   (assoc db :loop-end x)))\r\n\r\n(reg-event-db\r\n :next-note\r\n (fn [db [_ _]]\r\n   (let [tempo (subscribe [:tempo])\r\n         seconds-per-beat (/ 60.0 @tempo)]\r\n     (update \r\n      (update db :current-note inc)\r\n      :next-note-time #(+ % seconds-per-beat)))))\r\n\r\n(reg-event-db\r\n :play-note\r\n (fn [db [_ pitch]]\r\n   (music/play-note pitch)\r\n   (assoc db :notes-in-queue [{:pitch pitch\r\n                               :time  0}])))\r\n\r\n(reg-event-db\r\n :schedule-note\r\n (fn [db [_ _]]\r\n   (let [notes (subscribe [:notes])\r\n         beat (subscribe [:current-note])\r\n         to-play (filter #(= (+ 1 @beat) (:time %)) @notes)]\r\n     (update db :notes-in-queue\r\n             into to-play))))\r\n\r\n(reg-event-db\r\n :add-note\r\n (undoable \"add note\")\r\n (fn [db [_ instrument time pitch]]\r\n   (if (= (.-state @(subscribe [:audio-context])) \"suspended\")\r\n     (.resume @(subscribe [:audio-context])))\r\n   ;(sci-editor/update-editor! (str @(subscribe [:notes])))\r\n   (music/play-sample instrument (if @(subscribe [:sharp?]) (inc pitch) pitch))\r\n   (update db :notes\r\n           conj \r\n           {:time time\r\n            :instrument instrument\r\n            :pitch (if @(subscribe [:sharp?])\r\n                    (inc pitch) pitch)})\r\n   ))\r\n\r\n\r\n;; TODO This is gross.\r\n;; Make it so the run counter only runs when needed.\r\n;; But this tick function needs to be refactored.\r\n;; Seriously it's like 50 shades of awful.\r\n;; Read about effectful handlers some more,\r\n;; and learn to use reg-event-fx.\r\n\r\n(reg-event-db\r\n :tick!\r\n (fn [db [_ _]]\r\n   (if (and (not= 0 @(subscribe [:mario-jump]))\r\n            @(subscribe [:playing?]))\r\n     (assoc\r\n      (update\r\n       (update db :mario-run #(if (= % 12) 0 (inc %)))\r\n       :mario-jump #(if (= 8 %) 0 (inc %)))\r\n      :mario-y (- 61\r\n                  (get [5 10 15 25 30 25 15 5]\r\n                       @(subscribe [:mario-jump]))))\r\n     (update db :mario-run #(if (= % 12) 0 (inc %))))))\r\n\r\n(reg-event-db\r\n :jump!\r\n (fn [db [_ _]]\r\n   (assoc db :mario-jump 1)))\r\n\r\n(reg-event-db\r\n :submit-xml\r\n (fn [db [_ xml]]\r\n   (assoc db :xml xml)))\r\n\r\n(reg-event-db\r\n :load-song\r\n (fn [db [_ notes]]\r\n   (assoc db :notes notes)))\r\n\r\n(reg-event-db\r\n :load-megaman\r\n (fn [db [_ notes]]\r\n   (dispatch [:set-tempo 260])\r\n   (assoc db :notes\r\n          megaman/megaman)))\r\n\r\n(reg-event-db\r\n :load-castle\r\n (fn [db [_ notes]]\r\n   (dispatch [:set-tempo 150])\r\n   (assoc db :notes city/city)))\r\n\r\n(reg-event-db\r\n :load-zelda\r\n (fn [db [_ notes]]\r\n   (dispatch [:set-tempo 390])\r\n   (assoc db :notes zelda/zelda)))\r\n\r\n"]}
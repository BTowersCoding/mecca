{"version":3,"sources":["mecca/music.cljs"],"mappings":"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","names":["mecca.music/mario-jump","beat","re_frame.core.subscribe","notes","jump","and__4221__auto__","cljs.core/deref","cljs.core/count","p1__71312#","cljs.core.filter","cljs.core._EQ_","re-frame.core/dispatch","mecca.music/mario-move","playing?","now","length","cljs.core.apply","cljs.core/max","p1__71313#","cljs.core.map","started","elapsed","beat-length","end-time","current-beat","last-drawn-pos","mecca.music/dispatch-timer-event","js/mecca","js/mecca.music","js/mecca.music.do-timer","mecca.music/do-timer","js/setInterval","mecca.music/load-sound","named-url","out","cljs.core.async.chan","req","js/XMLHttpRequest","e","cljs.core.async.put_BANG_","cljs.core.assoc","cljs.core.async/close!","mecca.music/decode","decoded-buffer","js/console","cljs.core.prn","mecca.music/buffer-source","buffer","source","mecca.music/get-and-decode","c__47942__auto__","cljs.core.async.impl.dispatch/run","f__47943__auto__","switch__47757__auto__","state_71335","state_val_71336","inst_71324","cljs.core.async.impl.ioc-helpers/take!","inst_71326","statearr-71339","statearr-71340","statearr-71341","inst_71328","statearr-71342","inst_71333","cljs.core.async.impl.ioc-helpers/return-chan","inst_71330","statearr-71343","statearr-71344","state-machine__47758__auto__","ret-value__47759__auto__","result__47760__auto__","cljs.core/keyword-identical?","ex__47761__auto__","e71349","statearr-71350","cljs.core/seq","statearr-71351","cljs.core/first","state__47944__auto__","statearr-71355","cljs.core.async.impl.ioc-helpers/USER-START-IDX","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","mecca.music/load-samples","state_71387","state_val_71388","inst_71359","cljs.core/PersistentHashMap","inst_71360","inst_71361","inst_71362","statearr-71389","statearr-71390","inst_71364","inst_71365","inst_71366","cljs.core/not","statearr-71391","statearr-71392","inst_71385","inst_71368","inst_71369","inst_71370","inst_71371","inst_71372","inst_71373","statearr-71393","statearr-71394","inst_71383","statearr-71395","inst_71375","inst_71376","inst_71377","inst_71378","inst_71379","statearr-71396","statearr-71397","statearr-71398","e71399","statearr-71400","statearr-71401","statearr-71402","cljs.core.range","cljs.core/rest","js/mecca.music.loading-samples","mecca.music/loading-samples","state_71412","state_val_71413","inst_71403","cljs.core/PersistentVector","inst_71404","statearr-71414","inst_71406","inst_71407","inst_71408","inst_71409","inst_71410","statearr-71415","statearr-71416","e71417","statearr-71418","statearr-71419","statearr-71420","mecca.music/add-semitone","rate","js/Math","mecca.music/sub-semitone","mecca.music/inc-rate","semis","cljs.core.reduce","cljs.core.repeat","mecca.music/dec-rate","mecca.music/pitch->rate","midi-num","mecca.music/play-note","pitch","context","samples","instrument","audio-buffer","cljs.core.get","sample-source","mecca.music/play-sample","compressor","analyser","mecca.music/play-at","time","mecca.music/delay-note","beats","note","p1__71421#","cljs.core.update","mecca.music/advance-note","p1__71422#","mecca.music/queue-section","from","to","tempo","section","p1__71423#","advanced","p1__71424#","cljs.core.doall","iter__4622__auto__","s__71426","cljs.core/LazySeq","temp__5753__auto__","cljs.core/chunked-seq?","c__4620__auto__","size__4621__auto__","b__71428","cljs.core/chunk-buffer","i__71427","map__71429","cljs.core/-nth","cljs.core/--destructure-map","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__71425","cljs.core/chunk-rest","map__71430","cljs.core/cons","mecca.music/play-section","p1__71431#","p1__71432#","s__71434","b__71436","i__71435","map__71437","iter__71433","map__71438","mecca.music/play-notes","n","editor-start","play-pos","mecca.music/play-from-here","p1__71439#","mecca.music/play-song!","s__71441","b__71443","i__71442","map__71444","iter__71440","map__71445","mecca.music/get-bytes!","freq-data","cljs.core/chunk-first"],"sourcesContent":["(ns mecca.music\r\n  (:require\r\n   [cljs.core.async :refer [<! chan put! close!]]\r\n   [re-frame.core :as rf :refer [subscribe dispatch]])\r\n  (:require-macros\r\n   [cljs.core.async.macros :refer [go go-loop]]))\r\n\r\n(defn mario-jump []\r\n  (let [beat (subscribe [:current-position])\r\n        notes (subscribe [:notes])\r\n        jump (subscribe [:mario-jump])]\r\n    (when (and @(subscribe [:playing?])\r\n               (zero? @jump))\r\n      (if (< 0 (count (filter #(= (:time %) (inc @beat))\r\n                              @notes)))\r\n        (dispatch [:jump!])))))\r\n\r\n(defn mario-move []\r\n  (let [notes (subscribe [:notes])\r\n        playing? @(subscribe [:playing?])\r\n        now (.-currentTime @(subscribe [:audio-context]))\r\n        length (apply max (map #(:time %) @notes))\r\n        started (subscribe [:play-start])\r\n        elapsed (- now @started)\r\n        beat-length (/ 60 @(subscribe [:tempo]))\r\n        end-time (+ @started (* beat-length 4))\r\n        current-beat (/ elapsed beat-length)\r\n        last-drawn-pos (subscribe [:current-position])]\r\n    (when playing?\r\n      (if (< length current-beat)\r\n        (dispatch [:play-off])\r\n        (if (< @last-drawn-pos current-beat)\r\n          (do (dispatch [:move-mario])\r\n              (dispatch [:advance-position])))))\r\n    (mario-jump)))\r\n\r\n(defn dispatch-timer-event []\r\n  (dispatch [:tick!])\r\n  (mario-move))\r\n\r\n(defonce do-timer\r\n  (js/setInterval dispatch-timer-event 60))\r\n\r\n(defn load-sound [named-url]\r\n  (let [out (chan)\r\n        req (js/XMLHttpRequest.)]\r\n    (set! (.-responseType req) \"arraybuffer\")\r\n    (set! (.-onload req) (fn [e]\r\n                           (if (= (.-status req) 200)\r\n                             (do (put! out (assoc named-url :buffer (.-response req)))\r\n                                 (close! out))\r\n                             (close! out))))\r\n    (.open req \"GET\" (:url named-url) true)\r\n    (.send req)\r\n    out))\r\n\r\n(defn decode [named-url]\r\n  (let [out (chan)]\r\n    (if (:buffer named-url)\r\n      (do\r\n        (.decodeAudioData\r\n         @(subscribe [:audio-context]) (:buffer named-url)\r\n         (fn [decoded-buffer]\r\n           (put! out (assoc named-url :decoded-buffer decoded-buffer))\r\n           (close! out))\r\n         (fn []\r\n           (.error js/console \"Error loading file \" (prn named-url))\r\n           (close! out))))\r\n      (close! out))\r\n    out))\r\n\r\n(defn buffer-source [buffer]\r\n  (let [source (.createBufferSource @(subscribe [:audio-context]))]\r\n    (set! (.-buffer source) buffer)\r\n    source))\r\n\r\n(defn get-and-decode [named-url]\r\n  (go\r\n    (when-let [s (<! (load-sound named-url))]\r\n      (<! (decode s)))))\r\n\r\n(defn load-samples []\r\n  (go-loop [result {}\r\n            sounds (range 1 19)]\r\n    (if-not (nil? (first sounds))\r\n      (let [sound (first sounds)\r\n            decoded-buffer (<! (get-and-decode {:url (str \"/mecca/public/audio/\" sound \".mp3\")\r\n                                                :sound sound}))]\r\n        (prn sound)\r\n        (prn decoded-buffer)\r\n        (recur (assoc result sound decoded-buffer)\r\n               (rest sounds)))\r\n      result)))\r\n\r\n(defonce loading-samples\r\n  (go\r\n    (dispatch [:load-samples  (<! (load-samples))])\r\n    (prn \"Samples loaded\")))\r\n\r\n(defn add-semitone [rate]\r\n  (* rate (.pow js/Math 2 (/ 1 12))))\r\n\r\n(defn sub-semitone [rate]\r\n  (* rate (.pow js/Math 2 (/ -1 12))))\r\n\r\n(defn inc-rate [semis]\r\n  (reduce add-semitone (repeat semis 1)))\r\n\r\n(defn dec-rate [semis]\r\n  (reduce sub-semitone (repeat semis 1)))\r\n\r\n(defn pitch->rate [midi-num]\r\n  (if (< 66 midi-num)\r\n    (inc-rate (- midi-num 66))\r\n    (dec-rate (- 68 midi-num))))\r\n\r\n(defn play-note [pitch]\r\n  (let [context       @(subscribe [:audio-context])\r\n        samples       (subscribe [:samples])\r\n        instrument    (subscribe [:instrument])\r\n        audio-buffer  (:decoded-buffer (get @samples @instrument))\r\n        sample-source (.createBufferSource context)]\r\n    (set! (.-buffer sample-source) audio-buffer)\r\n    (.setValueAtTime\r\n     (.-playbackRate sample-source)\r\n     (pitch->rate pitch)\r\n     (.-currentTime context))\r\n    (.connect sample-source (.-destination context))\r\n    (.start sample-source)\r\n    sample-source))\r\n\r\n(defn play-sample [instrument pitch]\r\n  (let [context (subscribe [:audio-context])\r\n        samples (subscribe [:samples])\r\n        audio-buffer (:decoded-buffer (get @samples instrument))\r\n        sample-source (.createBufferSource @context)\r\n        compressor (.createDynamicsCompressor @context)\r\n        analyser (.createAnalyser @context)]\r\n    (set! (.-buffer sample-source) audio-buffer)\r\n    (.setValueAtTime\r\n     (.-playbackRate sample-source)\r\n     (pitch->rate pitch)\r\n     (.-currentTime @context))\r\n    (.connect sample-source analyser)\r\n    (.connect sample-source (.-destination @context))\r\n    (.start sample-source)\r\n    sample-source))\r\n\r\n(defn play-at [instrument pitch time]\r\n  (let [context (subscribe [:audio-context])\r\n        samples (subscribe [:samples])\r\n        audio-buffer (:decoded-buffer (get @samples instrument))\r\n        sample-source (.createBufferSource @context)]\r\n    (set! (.-buffer sample-source) audio-buffer)\r\n    (.setValueAtTime\r\n     (.-playbackRate sample-source)\r\n     (pitch->rate pitch)\r\n     time)\r\n    (.connect sample-source (.-destination @context))\r\n    (.start sample-source time)\r\n    sample-source))\r\n\r\n(defn delay-note [beats note]\r\n  (update note :time #(+ beats %)))\r\n\r\n(defn advance-note [beats note]\r\n  (update note :time #(- % beats)))\r\n\r\n(defn queue-section [from to]\r\n  (let [notes (subscribe [:notes])\r\n        started (subscribe [:play-start])\r\n        tempo (subscribe [:tempo])\r\n        section (filter #(<= from (:time %) to) @notes)\r\n        advanced (map #(advance-note from %) section)]\r\n    (doall (for [{:keys [time instrument pitch]} section]\r\n             (play-at instrument pitch (+ @started (* (/ 60 @tempo) time)))))))\r\n\r\n(defn play-section [from to]\r\n  (let [notes (subscribe [:notes])\r\n        now (.-currentTime @(subscribe [:audio-context]))\r\n        tempo (subscribe [:tempo])\r\n        section (filter #(<= from (:time %) to) @notes)\r\n        advanced (map #(advance-note from %) section)]\r\n    (doall (for [{:keys [time instrument pitch]} advanced]\r\n             (play-at instrument pitch (+ now (* (/ 60 @tempo) time)))))))\r\n\r\n(defn play-notes [n]\r\n  (let [editor-start (subscribe [:editor-beat-start])\r\n        tempo (subscribe [:tempo])\r\n        beat-length (/ 60 @(subscribe [:tempo]))\r\n        play-pos (if (< @editor-start 4)\r\n                   @editor-start\r\n                   (+ 4 @(subscribe [:editor-beat-start])))]\r\n    (play-section (dec play-pos) (+ (dec play-pos) (* n 0.5)))))\r\n\r\n(defn play-from-here []\r\n  (let [notes (subscribe [:notes])\r\n        editor-start (subscribe [:editor-beat-start])\r\n        play-pos ;(if (< @editor-start 4)\r\n        @editor-start\r\n                  ; (+ 4 @(subscribe [:editor-beat-start])))\r\n        length (apply max (map #(:time %) @notes))]\r\n    (play-section (dec play-pos) (+ 16 play-pos))))\r\n\r\n(defn play-song! []\r\n  (let [notes (subscribe [:notes])\r\n        now (.-currentTime @(subscribe [:audio-context]))\r\n        tempo (subscribe [:tempo])]\r\n    (dispatch [:reset-position])\r\n    (doall (for [{:keys [time instrument pitch]} @notes]\r\n             (play-at instrument pitch (+ now (* (/ 60 @tempo) time)))))))\r\n\r\n(defn get-bytes! [analyser freq-data]\r\n  (.getByteFrequencyData analyser freq-data)\r\n  freq-data)\r\n"]}